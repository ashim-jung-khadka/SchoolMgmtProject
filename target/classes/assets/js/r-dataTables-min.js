"use strict";function ResponsiveDatatablesHelper(e,t,n){if(typeof e==="string"){this.tableElement=jQuery(e)}else{this.tableElement=e}this.columnIndexes=[];this.columnsShownIndexes=[];this.columnsHiddenIndexes=[];this.expandColumn=undefined;this.breakpoints={};this.options={hideEmptyColumnsInRowDetail:false};this.expandIconTemplate='<span class="responsiveExpander"></span>';this.rowTemplate='<tr class="row-detail"><td><ul><!--column item--></ul></td></tr>';this.rowLiTemplate='<li><span class="columnTitle"><!--column title--></span>: <span class="columnValue"><!--column value--></span></li>';this.disabled=true;this.skipNextWindowsWidthChange=false;this.init(t,n)}ResponsiveDatatablesHelper.prototype.init=function(e,t){e["always"]=Infinity;var n=[];_.each(e,function(e,t){n.push({name:t,upperLimit:e,columnsToHide:[]})});n=_.sortBy(n,"upperLimit");var r=undefined;_.each(n,function(e){e.lowerLimit=r;r=e.upperLimit});n.push({name:"default",lowerLimit:r,upperLimit:undefined,columnsToHide:[]});for(var i=0,s=n.length;i<s;i++){this.breakpoints[n[i].name]=n[i]}var o=this.tableElement.fnSettings().aoColumns;for(var i=0,s=o.length;i<s;i++){if(o[i].bVisible){this.columnIndexes.push(i)}}var u=this.tableElement.fnSettings().aoColumns;u=_.filter(u,function(e){return e.bVisible});_.each(u,function(e,t){if(jQuery(e.nTh).attr("data-class")==="expand"){this.expandColumn=this.columnIndexes[t]}var n=jQuery(e.nTh).attr("data-hide");if(n!==undefined){var r=n.split(/,\s*/);_.each(r,function(e){if(this.breakpoints[e]!==undefined){this.breakpoints[e].columnsToHide.push(this.columnIndexes[t])}},this)}},this);this.disable(false);_.extend(this.options,t)};ResponsiveDatatablesHelper.prototype.setWindowsResizeHandler=function(e){if(e===undefined){e=true}if(e){var t=this;jQuery(window).bind("resize",function(){t.respond()})}else{jQuery(window).unbind("resize")}};ResponsiveDatatablesHelper.prototype.respond=function(){if(this.disabled){return}var e=this;var t=jQuery(window).width();var n=0;var r=[];_.each(this.breakpoints,function(e){if((!e.lowerLimit||t>e.lowerLimit)&&(!e.upperLimit||t<=e.upperLimit)){r=e.columnsToHide}},this);var i=false;if(!this.skipNextWindowsWidthChange){if(this.columnsHiddenIndexes.length!==r.length){i=true}else{var s=_.difference(this.columnsHiddenIndexes,r).length;var o=_.difference(r,this.columnsHiddenIndexes).length;i=s+o>0}}if(i){this.skipNextWindowsWidthChange=true;this.columnsHiddenIndexes=r;this.columnsShownIndexes=_.difference(this.columnIndexes,this.columnsHiddenIndexes);this.showHideColumns();n=this.columnsHiddenIndexes.length;this.skipNextWindowsWidthChange=false}if(this.columnsHiddenIndexes.length){this.tableElement.addClass("has-columns-hidden");jQuery("tr.detail-show",this.tableElement).each(function(t,n){var r=jQuery(n);if(r.next(".row-detail").length===0){ResponsiveDatatablesHelper.prototype.showRowDetail(e,r)}})}else{this.tableElement.removeClass("has-columns-hidden");jQuery("tr.row-detail").each(function(t){ResponsiveDatatablesHelper.prototype.hideRowDetail(e,jQuery(this).prev())})}};ResponsiveDatatablesHelper.prototype.showHideColumns=function(){for(var e=0,t=this.columnsShownIndexes.length;e<t;e++){this.tableElement.fnSetColumnVis(this.columnsShownIndexes[e],true,false)}for(var e=0,t=this.columnsHiddenIndexes.length;e<t;e++){this.tableElement.fnSetColumnVis(this.columnsHiddenIndexes[e],false,false)}var n=this;jQuery("tr.row-detail").each(function(){ResponsiveDatatablesHelper.prototype.hideRowDetail(n,jQuery(this).prev())});if(this.tableElement.hasClass("has-columns-hidden")){jQuery("tr.detail-show",this.tableElement).each(function(e,t){ResponsiveDatatablesHelper.prototype.showRowDetail(n,jQuery(t))})}};ResponsiveDatatablesHelper.prototype.createExpandIcon=function(e){if(this.disabled){return}var t=jQuery("td",e);var n=this;for(var r=0,i=t.length;r<i;r++){var s=t[r];var o=n.tableElement.fnGetPosition(s)[2];s=jQuery(s);if(o===n.expandColumn){if(jQuery("span.responsiveExpander",s).length==0){s.prepend(n.expandIconTemplate);s.on("click","span.responsiveExpander",{responsiveDatatablesHelperInstance:n},n.showRowDetailEventHandler)}break}}};ResponsiveDatatablesHelper.prototype.showRowDetailEventHandler=function(e){if(this.disabled){return}var t=jQuery(this).closest("tr");if(t.hasClass("detail-show")){ResponsiveDatatablesHelper.prototype.hideRowDetail(e.data.responsiveDatatablesHelperInstance,t)}else{ResponsiveDatatablesHelper.prototype.showRowDetail(e.data.responsiveDatatablesHelperInstance,t)}t.toggleClass("detail-show");e.stopPropagation()};ResponsiveDatatablesHelper.prototype.showRowDetail=function(e,t){var n=e.tableElement;var r=n.fnSettings().aoColumns;var i=jQuery(e.rowTemplate);var s=jQuery("ul",i);_.each(e.columnsHiddenIndexes,function(i){var o=n.fnGetPosition(t[0]);var u=n.fnGetTds(o)[i];if(!e.options.hideEmptyColumnsInRowDetail||u.innerHTML.trim().length){var a=jQuery(e.rowLiTemplate);jQuery(".columnTitle",a).html(r[i].sTitle);var f=jQuery(u).contents().clone();jQuery(".columnValue",a).html(f);a.attr("data-column",i);var l=jQuery(u).attr("class");if(l!=="undefined"&&l!==false&&l!==""){a.addClass(l)}s.append(a)}});var o=e.columnIndexes.length-e.columnsHiddenIndexes.length;i.find("> td").attr("colspan",o);t.after(i)};ResponsiveDatatablesHelper.prototype.hideRowDetail=function(e,t){t.next(".row-detail").find("li").each(function(){var n=e.tableElement;var r=n.fnSettings().aoData;var i=n.fnGetPosition(t[0]);var s=jQuery(this).attr("data-column");var o=jQuery(this).find("span.columnValue").contents();r[i]._anHidden[s]=jQuery(r[i]._anHidden[s]).empty().append(o)[0]});t.next(".row-detail").remove()};ResponsiveDatatablesHelper.prototype.disable=function(e){this.disabled=e===undefined||e;if(this.disabled){this.setWindowsResizeHandler(false);jQuery("tbody tr.row-detail",this.tableElement).remove();jQuery("tbody tr",this.tableElement).removeClass("detail-show");jQuery("tbody tr span.responsiveExpander",this.tableElement).remove();this.columnsHiddenIndexes=[];this.columnsShownIndexes=this.columnIndexes;this.showHideColumns();this.tableElement.removeClass("has-columns-hidden");this.tableElement.off("click","span.responsiveExpander",this.showRowDetailEventHandler)}else{this.setWindowsResizeHandler()}};jQuery.fn.dataTableExt.oApi.fnGetTds=function(e,t){var n=[];var r=[];var i=0;var s,o,u;var a=typeof t=="object"?e.oApi._fnNodeToDataIndex(e,t):t;var f=e.aoData[a].nTr;for(o=0,u=f.childNodes.length;o<u;o++){s=f.childNodes[o];if(s.nodeName.toUpperCase()=="TD"){r.push(s)}}for(o=0,u=e.aoColumns.length;o<u;o++){if(e.aoColumns[o].bVisible){n.push(r[o-i])}else{n.push(e.aoData[a]._anHidden[o]);i++}}return n}